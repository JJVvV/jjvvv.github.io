<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Mapped types先定义一个 Person 类型： 1234interface Person &amp;#123;  name: string;  age: number;&amp;#125; 你可能想把它每个属性变成只读： 1234interface PersonReadonly &amp;#123;  readonly name: string;  readonly age: number;&amp;#125; 这种场"><meta name="keywords" content="TypeScript"><meta property="og:type" content="article"><meta property="og:title" content="TypeScript 常用高级类型总结"><meta property="og:url" content="https://jjvvv.github.io/2018/09/10/TypeScript-常用高级类型总结/index.html"><meta property="og:site_name" content="Alex"><meta property="og:description" content="Mapped types先定义一个 Person 类型： 1234interface Person &amp;#123;  name: string;  age: number;&amp;#125; 你可能想把它每个属性变成只读： 1234interface PersonReadonly &amp;#123;  readonly name: string;  readonly age: number;&amp;#125; 这种场"><meta property="og:locale" content="default"><meta property="og:updated_time" content="2019-05-11T01:53:39.294Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="TypeScript 常用高级类型总结"><meta name="twitter:description" content="Mapped types先定义一个 Person 类型： 1234interface Person &amp;#123;  name: string;  age: number;&amp;#125; 你可能想把它每个属性变成只读： 1234interface PersonReadonly &amp;#123;  readonly name: string;  readonly age: number;&amp;#125; 这种场"><link rel="shortcut icon" href="/images/avatar_s.png"><link rel="icon" type="image/png" href="/images/avatar_s.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/avatar_s.png"><title>TypeScript 常用高级类型总结</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/rtl.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"></head><body class="max-width mx-auto px3 ltr"><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a><a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a><a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fas fa-chevron-up fa-lg"></i></a><span id="menu"><span id="nav"><ul><li> <a href="/">Home</a></li><li> <a href="/archives/">Writing</a></li><li> <a href="/categories/">Categories</a></li><li> <a href="/tags/">Tags</a></li><li> <a href="/about/">About</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="/2018/09/11/React-vs-Vue-之-Vue-组件通信/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" href="/2018/09/10/React-vs-Vue-之-React-组件通信/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul> <span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://jjvvv.github.io/2018/09/10/TypeScript-常用高级类型总结/"><i class="fab fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://jjvvv.github.io/2018/09/10/TypeScript-常用高级类型总结/&text=TypeScript 常用高级类型总结"><i class="fab fa-twitter" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mapped-types"><span class="toc-number">1.</span> <span class="toc-text">Mapped types</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Readonly-lt-T-gt"><span class="toc-number">2.</span> <span class="toc-text">Readonly&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Required2-lt-T-P-gt"><span class="toc-number">3.</span> <span class="toc-text">Required2&lt;T, P&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Partial-lt-T-gt"><span class="toc-number">4.</span> <span class="toc-text">Partial&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Partial2-lt-T-P-gt"><span class="toc-number">5.</span> <span class="toc-text">Partial2&lt;T, P&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pick-lt-T-K-gt"><span class="toc-number">6.</span> <span class="toc-text">Pick&lt;T, K&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Record-lt-K-T-gt"><span class="toc-number">7.</span> <span class="toc-text">Record&lt;K, T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Omit-lt-T-K-gt"><span class="toc-number">8.</span> <span class="toc-text">Omit&lt;T, K&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exclude-lt-T-U-gt"><span class="toc-number">9.</span> <span class="toc-text">Exclude&lt;T, U&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extract-lt-T-U-gt"><span class="toc-number">10.</span> <span class="toc-text">Extract&lt;T, U&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#keyof-T"><span class="toc-number">11.</span> <span class="toc-text">[keyof T]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Filter-lt-T-P-gt"><span class="toc-number">12.</span> <span class="toc-text">Filter&lt;T, P&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mutable-lt-T-gt"><span class="toc-number">13.</span> <span class="toc-text">Mutable&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ReturnType-lt-T-gt"><span class="toc-number">14.</span> <span class="toc-text">ReturnType&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NonNullable-lt-T-gt"><span class="toc-number">15.</span> <span class="toc-text">NonNullable&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#infer"><span class="toc-number">16.</span> <span class="toc-text">infer</span></a></li></ol></div></span></div><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline"> TypeScript 常用高级类型总结</h1><div class="meta"> <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Alex</span></span><div class="postdate"> <time datetime="2018-09-10T15:00:12.000Z" itemprop="datePublished">2018-09-10</time> (Updated: <time datetime="2019-05-11T01:53:39.294Z" itemprop="dateModified">2019-05-11</time>)</div><div class="article-category"><i class="fas fa-archive"></i> <a class="category-link" href="/categories/JavaScript/">JavaScript</a></div><div class="article-tag"><i class="fas fa-tag"></i> <a class="tag-link" href="/tags/TypeScript/">TypeScript</a></div></div></header><div class="content" itemprop="articleBody"><h2 id="Mapped-types"><a href="#Mapped-types" class="headerlink" title="Mapped types"></a>Mapped types</h2><p>先定义一个 Person 类型：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Person &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>你可能想把它每个属性变成只读：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> PersonReadonly &#123;</span><br><span class="line">  readonly name: <span class="built_in">string</span>;</span><br><span class="line">  readonly age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这种场景很常见，一个类型需要根据另一个类型来生成。TypeScript 提供了一种基于旧类型创建新类型的方法 - <strong>映射类型</strong>(Mapped types)。</p><p>映射类型类似于 javascript 中的高阶函数，输入一个类型，返回一个新的类型：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 伪代码</span></span><br><span class="line"><span class="keyword">type</span> Type2 = Func(Type1)</span><br></pre></td></tr></table></figure><h2 id="Readonly-lt-T-gt"><a href="#Readonly-lt-T-gt" class="headerlink" title="Readonly&lt;T&gt;"></a><code>Readonly&lt;T&gt;</code></h2><p>将 T 中的属性变为只读（内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Readonly&lt;T&gt; = &#123; readonly [P <span class="keyword">in</span> keyof T]: T[P] &#125;;</span><br></pre></td></tr></table></figure><p>##<code>Required&lt;P&gt;</code></p><p>将 P 中的属性变为必选（内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Required&lt;T&gt; = &#123; [P <span class="keyword">in</span> keyof T]-?: T[P] &#125;;</span><br><span class="line"><span class="keyword">type</span> Person2 = Required&lt;&#123; name: <span class="built_in">string</span>; age?: <span class="built_in">number</span> &#125;&gt;; <span class="comment">// &#123;name: string; age: number&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Required2-lt-T-P-gt"><a href="#Required2-lt-T-P-gt" class="headerlink" title="Required2&lt;T, P&gt;"></a><code>Required2&lt;T, P&gt;</code></h2><p>将 T 中的 P 属性变为必选（非内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不包含需要可选属性的对象 &amp; 只包含可选值得对象并进行可选操作</span></span><br><span class="line"><span class="keyword">type</span> Required2&lt;T, P <span class="keyword">extends</span> keyof T&gt; = Omit&lt;T, P&gt; &amp; Required&lt;Pick&lt;T, P&gt;&gt;;</span><br><span class="line"><span class="keyword">type</span> Person2 = Required2&lt;</span><br><span class="line">  &#123; name: <span class="built_in">string</span>; age?: <span class="built_in">number</span>; school?: <span class="built_in">string</span> &#125;,</span><br><span class="line">  <span class="string">"age"</span></span><br><span class="line">&gt;;</span><br><span class="line"><span class="comment">// &#123;name: string; age: number; school?: string&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Partial-lt-T-gt"><a href="#Partial-lt-T-gt" class="headerlink" title="Partial&lt;T&gt;"></a><code>Partial&lt;T&gt;</code></h2><p>将 T 中的属性变成可选（内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Partial&lt;T&gt; = &#123; [P <span class="keyword">in</span> keyof T]?: T[P] &#125;;</span><br><span class="line"><span class="keyword">type</span> PersonPartial = Partial&lt;Person&gt;; <span class="comment">// &#123;name?:string; age?:number&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Partial2-lt-T-P-gt"><a href="#Partial2-lt-T-P-gt" class="headerlink" title="Partial2&lt;T, P&gt;"></a><code>Partial2&lt;T, P&gt;</code></h2><p>将 T 中 P 属性变为可选（非内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不包含需要可选属性的对象 &amp; 只包含可选值得对象并进行可选操作</span></span><br><span class="line"><span class="keyword">type</span> Partial2&lt;T, P <span class="keyword">extends</span> keyof T&gt; = Omit&lt;T, P&gt; &amp; Partial&lt;Pick&lt;T, P&gt;&gt;;</span><br><span class="line"><span class="keyword">type</span> Person2 = Partial2&lt;Person, <span class="string">"age"</span>&gt;; <span class="comment">// &#123;name: string; age?: number&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Pick-lt-T-K-gt"><a href="#Pick-lt-T-K-gt" class="headerlink" title="Pick&lt;T, K&gt;"></a><code>Pick&lt;T, K&gt;</code></h2><p>从 T 中选择出 K 属性（内置）组成新的对象。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Pick&lt;T, K <span class="keyword">extends</span> keyof T&gt; = &#123; [P <span class="keyword">in</span> K]: T[P] &#125;;</span><br><span class="line"><span class="keyword">type</span> Person2 = Pick&lt;Person, <span class="string">"name"</span>&gt;; <span class="comment">// &#123;name: string&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Record-lt-K-T-gt"><a href="#Record-lt-K-T-gt" class="headerlink" title="Record&lt;K, T&gt;"></a><code>Record&lt;K, T&gt;</code></h2><p>用属性为 K 的类型，值为 T 的类型生成新的对象（内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Record&lt;K <span class="keyword">extends</span> keyof <span class="built_in">any</span>, T&gt; = &#123;</span><br><span class="line">    [P <span class="keyword">in</span> K]: T;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Type Person = Record&lt;<span class="string">'name'</span>|<span class="string">'school'</span>, <span class="built_in">string</span>&gt; <span class="comment">// &#123;name: string; school: string&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Omit-lt-T-K-gt"><a href="#Omit-lt-T-K-gt" class="headerlink" title="Omit&lt;T, K&gt;"></a><code>Omit&lt;T, K&gt;</code></h2><p>从对象 T 中排除属性是 K 的属性（没有内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Omit&lt;T, K&gt; = Pick&lt;T, Exclude&lt;keyof T, K&gt;&gt;</span><br><span class="line"><span class="keyword">type</span> Person2 = Omit&lt;Person, <span class="string">'age'</span>&gt; <span class="comment">// &#123;name: string&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Exclude-lt-T-U-gt"><a href="#Exclude-lt-T-U-gt" class="headerlink" title="Exclude&lt;T, U&gt;"></a><code>Exclude&lt;T, U&gt;</code></h2><p>从 T 中排除是 U 的类型（内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Exclude&lt;T, U&gt; = T <span class="keyword">extends</span> U ? never : T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T00 = Exclude&lt;<span class="string">"a"</span> | <span class="string">"b"</span> | <span class="string">"c"</span> | <span class="string">"d"</span>, <span class="string">"a"</span> | <span class="string">"c"</span> | <span class="string">"f"</span>&gt;; <span class="comment">// "b" | "d"·</span></span><br></pre></td></tr></table></figure><h2 id="Extract-lt-T-U-gt"><a href="#Extract-lt-T-U-gt" class="headerlink" title="Extract&lt;T, U&gt;"></a><code>Extract&lt;T, U&gt;</code></h2><p>从 T 中提取属于 U 的类型（内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Extract&lt;T, U&gt; = T <span class="keyword">extends</span> U ? T : never;</span><br><span class="line"><span class="keyword">type</span> T01 = Extract&lt;<span class="string">"a"</span> | <span class="string">"b"</span> | <span class="string">"c"</span> | <span class="string">"d"</span>, <span class="string">"a"</span> | <span class="string">"c"</span> | <span class="string">"f"</span>&gt;; <span class="comment">// "a" | "c"</span></span><br></pre></td></tr></table></figure><h2 id="keyof-T"><a href="#keyof-T" class="headerlink" title="[keyof T]"></a><code>[keyof T]</code></h2><p>获取 value</p><p>获取值为 function 类型的 key。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> FunctionPropertyNames&lt;T&gt; = &#123;</span><br><span class="line">  [K <span class="keyword">in</span> keyof T]: T[K] <span class="keyword">extends</span> <span class="built_in">Function</span> ? K : never</span><br><span class="line">&#125;[keyof T];</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PersonValue = Person[keyof Person]; <span class="comment">// "string" | "number"</span></span><br></pre></td></tr></table></figure><h2 id="Filter-lt-T-P-gt"><a href="#Filter-lt-T-P-gt" class="headerlink" title="Filter&lt;T, P&gt;"></a><code>Filter&lt;T, P&gt;</code></h2><p>过滤 T 中值类型为 P 类型的 key 组成新的对象（非内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> FilterType&lt;T, P&gt; = &#123; [K <span class="keyword">in</span> keyof T]: T[K] <span class="keyword">extends</span> P ? K : never &#125;[keyof T];</span><br><span class="line"><span class="keyword">type</span> Filter&lt;T, P&gt; = Pick&lt;T, FilterType&lt;T, P&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 过滤所有 value 为 string 类型的 key</span></span><br><span class="line"><span class="keyword">type</span> PersonStr = Filter&lt;Person, <span class="built_in">String</span>&gt;; <span class="comment">// &#123;name: string&#125;</span></span><br></pre></td></tr></table></figure><p>这里利用了条件类型（Conditional Types），使用条件类型可以完成更多操作。<br>比如我们要让一个对象所有的属性变成可选，包括深层次的对象引用：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Child = &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> TP = &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  children: Child[];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PartialDeep&lt;T&gt; = &#123;</span><br><span class="line">  [K <span class="keyword">in</span> keyof T]?: T[K] <span class="keyword">extends</span> (infer U)[]</span><br><span class="line">    ? PartialDeep&lt;U&gt;[]</span><br><span class="line">    : T[k] <span class="keyword">extends</span> object</span><br><span class="line">    ? PartialDeep&lt;T[K]&gt;</span><br><span class="line">    : T[K]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PartialTP = PartialDeep&lt;TP&gt;;</span><br><span class="line"><span class="keyword">const</span> parent: PartialTP = &#123; children: [&#123;&#125;] &#125;; <span class="comment">// 所有的属性都为可选值，包括children里的对象</span></span><br></pre></td></tr></table></figure><h2 id="Mutable-lt-T-gt"><a href="#Mutable-lt-T-gt" class="headerlink" title="Mutable&lt;T&gt;"></a><code>Mutable&lt;T&gt;</code></h2><p>T 变成可写。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Mutable&lt;T&gt; = &#123; -readonly [P <span class="keyword">in</span> keyof T]: T[P] &#125;;</span><br></pre></td></tr></table></figure><h2 id="ReturnType-lt-T-gt"><a href="#ReturnType-lt-T-gt" class="headerlink" title="ReturnType&lt;T&gt;"></a><code>ReturnType&lt;T&gt;</code></h2><p>获取函数返回类型（内置）。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ReturnType&lt;T <span class="keyword">extends</span> (...args: <span class="built_in">any</span>) =&gt; <span class="built_in">any</span>&gt; = T <span class="keyword">extends</span> (</span><br><span class="line">  ...args: <span class="built_in">any</span></span><br><span class="line">) =&gt; infer R</span><br><span class="line">  ? R</span><br><span class="line">  : <span class="built_in">any</span>;</span><br><span class="line"><span class="keyword">type</span> TFunc = <span class="function">(<span class="params">...args: <span class="built_in">any</span>[]</span>) =&gt;</span> <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">type</span> Ret = ReturnType&lt;TFunc&gt;; <span class="comment">// string</span></span><br></pre></td></tr></table></figure><h2 id="NonNullable-lt-T-gt"><a href="#NonNullable-lt-T-gt" class="headerlink" title="NonNullable&lt;T&gt;"></a><code>NonNullable&lt;T&gt;</code></h2><p>排除 null 和 undefined</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> NonNullable&lt;T&gt; = T <span class="keyword">extends</span> <span class="literal">null</span> | <span class="literal">undefined</span> ? never : T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person = &#123;</span><br><span class="line">  name: <span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> NonNull&lt;T&gt; = &#123; [K <span class="keyword">in</span> keyof T]: NonNullable&lt;T[K]&gt; &#125;;</span><br><span class="line"><span class="keyword">type</span> PersonNonNull = NonNull&lt;Person&gt;; <span class="comment">// &#123;name: string; age: number&#125;</span></span><br></pre></td></tr></table></figure><h2 id="infer"><a href="#infer" class="headerlink" title="infer"></a>infer</h2><p>infer 关键字常被用来获取函数返回类型。<br>我们看以下 ReturnType 的定义：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ReturnType&lt;T <span class="keyword">extends</span> (...args: <span class="built_in">any</span>) =&gt; <span class="built_in">any</span>&gt; = T <span class="keyword">extends</span> (</span><br><span class="line">  ...args: <span class="built_in">any</span></span><br><span class="line">) =&gt; infer R</span><br><span class="line">  ? R</span><br><span class="line">  : <span class="built_in">any</span>;</span><br></pre></td></tr></table></figure><p><strong>infer</strong> 关键字的含义是：<strong>获得 infer 所在位置的推断类型并赋值给 R</strong>。上例中 infer 的位置刚好是在函数的返回值，所以 R 就为函数返回类型了。</p><p>获取函数参数类型：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ArgumentsType&lt;T <span class="keyword">extends</span> (...args: infer AType) =&gt; <span class="built_in">any</span>&gt; = AType;</span><br><span class="line"><span class="comment">// 'infer' declarations are only permitted in the 'extends' clause of a conditional type.ts(1338)</span></span><br></pre></td></tr></table></figure><p>上边这种写法是不允许的，因为 infer 只允许在 extends 的条件判断类型中使用，我们强行给上边加一个条件判断：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ArgumentsType&lt;T <span class="keyword">extends</span> (...args: <span class="built_in">any</span>) =&gt; <span class="built_in">any</span>&gt; = T <span class="keyword">extends</span> (</span><br><span class="line">  ...args: infer TArgs</span><br><span class="line">) =&gt; <span class="built_in">any</span></span><br><span class="line">  ? TArgs</span><br><span class="line">  : never;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Fn = <span class="function">(<span class="params">a: <span class="built_in">string</span>, b: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">type</span> ArgFn = ArgumentsType&lt;Fn&gt;; <span class="comment">// [string, number]</span></span><br></pre></td></tr></table></figure></div></article><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments.</noscript></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li> <a href="/">Home</a></li><li> <a href="/archives/">Writing</a></li><li> <a href="/categories/">Categories</a></li><li> <a href="/tags/">Tags</a></li><li> <a href="/about/">About</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mapped-types"><span class="toc-number">1.</span> <span class="toc-text">Mapped types</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Readonly-lt-T-gt"><span class="toc-number">2.</span> <span class="toc-text">Readonly&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Required2-lt-T-P-gt"><span class="toc-number">3.</span> <span class="toc-text">Required2&lt;T, P&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Partial-lt-T-gt"><span class="toc-number">4.</span> <span class="toc-text">Partial&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Partial2-lt-T-P-gt"><span class="toc-number">5.</span> <span class="toc-text">Partial2&lt;T, P&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pick-lt-T-K-gt"><span class="toc-number">6.</span> <span class="toc-text">Pick&lt;T, K&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Record-lt-K-T-gt"><span class="toc-number">7.</span> <span class="toc-text">Record&lt;K, T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Omit-lt-T-K-gt"><span class="toc-number">8.</span> <span class="toc-text">Omit&lt;T, K&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exclude-lt-T-U-gt"><span class="toc-number">9.</span> <span class="toc-text">Exclude&lt;T, U&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extract-lt-T-U-gt"><span class="toc-number">10.</span> <span class="toc-text">Extract&lt;T, U&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#keyof-T"><span class="toc-number">11.</span> <span class="toc-text">[keyof T]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Filter-lt-T-P-gt"><span class="toc-number">12.</span> <span class="toc-text">Filter&lt;T, P&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mutable-lt-T-gt"><span class="toc-number">13.</span> <span class="toc-text">Mutable&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ReturnType-lt-T-gt"><span class="toc-number">14.</span> <span class="toc-text">ReturnType&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NonNullable-lt-T-gt"><span class="toc-number">15.</span> <span class="toc-text">NonNullable&lt;T&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#infer"><span class="toc-number">16.</span> <span class="toc-text">infer</span></a></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://jjvvv.github.io/2018/09/10/TypeScript-常用高级类型总结/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://jjvvv.github.io/2018/09/10/TypeScript-常用高级类型总结/&text=TypeScript 常用高级类型总结"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="menu" class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a><a id="toc" class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a><a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left"> Copyright &copy; 2019 Alex Liu</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archives/">Writing</a></li><li><a href="/categories/">Categories</a></li><li><a href="/tags/">Tags</a></li><li><a href="/about/">About</a></li></ul></nav></div></footer></div><script src="/lib/jquery/jquery.min.js"></script><script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script><script src="/js/main.js"></script><script type="text/javascript">var disqus_shortname="jjvvv";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script></body></html>